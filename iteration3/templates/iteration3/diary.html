﻿{% load static %}
{% if request.session.is_login %}
    <head>
      <!-- BEGIN: Title -->
      <title>Diatastic &mdash; Easily Manage Blood Sugar</title>
      <!-- END: Title -->

      <!-- BEGIN: Meta -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <!-- END: Meta -->

      <!-- BEGIN: Favicon -->
      <link rel="shortcut icon" href="/static/images/icons8-rh-plus-gradient-16.png">
      <!-- END: Favicon -->

      <!-- BEGIN: Stylesheets -->
        <!-- Latest compiled and minified CSS -->
      <link rel="stylesheet" href="/static/css/bootstrap/bootstrap.css">
      <link rel="stylesheet" href="/static/css/tiny-slider.css">
      <link rel="stylesheet" href="/static/fonts/lineicons/LineIcons.min.css">
      <link rel="stylesheet" href="/static/fonts/icomoon/style.css">
      <link rel="stylesheet" href="/static/css/animate.min.css">
      <link rel="stylesheet" href="/static/css/jquery.lavalamp.css">
      <link rel="stylesheet" href="/static/css/jquery.fancybox.min.css">
      <link rel="stylesheet" href="/static/css/style.css">
      <link rel="stylesheet" href="/static/css/select.css">
      <!-- END: Stylesheets -->


    <script src="/static/js/bot.js" defer></script>
    </head>

    <body>




      <!-- BEGIN: .site-wrap -->
      <div class="site-wrap">

        <!-- BEGIN: #site-header -->
        <!--
          Add class '.position-relative' to display it as stack.
          Add '.navbar-light' to make the text dark or black.
        -->
        <header id="site-header" class="position-relative">

          <!-- Add '.navbar_dark' class if you want the color of the text to -->
          <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">

              <!-- BEGIN: .navbar-brand -->
              <a class="navbar-brand" href="/iteration2/index/">
              <img src="/static/images/icons8-rh-plus-gradient-32.png" >Diatastic
              </a>
              <!-- END: .navbar-brand -->

              <!-- BEGIN: .navbar-toggler -->
              <a href="#" class="burger-toggle-menu js-burger-toggle-menu ml-auto py-4" data-toggle="collapse" data-target="#main-nav" aria-controls="main-nav" aria-expanded="false" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
              </a>
              <!-- END: .navbar-toggler -->

              <!-- BEGIN: #main-nav -->
              <div class="collapse navbar-collapse" id="main-nav">

                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                    <a class="nav-link" href="/index/">Home</a>
                  </li>
                  <li class="nav-item  active">
                    <a class="nav-link" href="/diary/">Diary</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">History</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/guide/">Beginner's Guide</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Tips and Tricks</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">F&Q</a>
                  </li>
                </ul>
                </ul>

              </div>
              <!-- END: #main-nav -->

            </div>
          </nav>
        </header>
        <!-- END: #site-header -->

{% block content %}
        <!-- BEGIN: .cover -->
        <div class="page-heading-85912" style="background-image: url('images/hero_bg_3.jpg')">
          <div class="container">
            <div class="row align-items-end">
              <div class="col-lg-7">
                <h1 class="mb-0 heading text-white">Diary</h1>
                <p class="mb-0 text-white">Healthy living starts with your diet. </p>
              </div>
            </div>
          </div>
        </div>

        <div class="custom-breadcrumns-23195 border-bottom">
          <div class="container">
            <a href="/iteration2/index/">Home</a>
            <span class="mx-3 icon-keyboard_arrow_right"></span>
            <span class="current">Diary</span>
            <a href="/carb_chart/" style="float:right"><button type="add" class="btn btn-outline-primary">Carb Chart</button></a>
            <a href="/list_view/" style="float:right"><button type="add" class="btn btn-outline-primary">List View</button></a>
          </div>
        </div>
        <span></span>

        <!-- BEGIN: diary form -->
          <form method="post"
                id="DiaryForm"
                action="/iteration2/create_view/"
                data-portion-url="{% url 'ajax_load_portion' %}">
              {% csrf_token %}
            <div class="container">
                    <div class="form-check">
                        <label for="date">Date: </label>
                        <input name="date" id="date" type="date"
                               class="form-control" required="required" placeholder="please enter date"></input>
                    </div>

                    <div class="form-check">
                        <label for="time">Time: </label>
                        <input name="time" id="time" type="time"
                               class="form-control" required="required" placeholder="{{ diary_entry.time }}"></input>
                    </div>

                    <div class="form-check">
                        <label for="blood_sugar_level"/>Blood Sugar Level: </label>
                        <input name="blood_sugar_level" id="blood_sugar_level"
                               type="Decimal" class="form-control" required="required" placeholder="{{ diary_entry.blood_sugar_level }}"></input>
                    </div>

                    <div class="form-check">
                        <label for="category"/>Category:</label>
                        <select id="category" name="category"
                                class="form-control"
                                action="{% url 'ajax_load_portion' %}"
                                required="required">

                            <option value="">---------</option>

                            {% for cat in category %}
                                <option value="{{ cat.id }}">{{ cat.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-check">
                        <label for="portion"/>Portion:</label>
                        <select name="portion" id="portion"
                                class="form-control dropdown"
                                required="required">

                            <option value="-----------">-----------</option>

                                {% for item in portion %}
                                    <option value="{{ item.id }}">{{ item.name }}</option>
                                {% endfor %}
                        </select>
                    </div>

                    <div class="form-check">
                        <label for="quantity"/>Quantity:</label>
                        <input name="quantity" id="quantity" class="form-control" type="number" value="1" oninput="value=value.replace(/[^\d]/g,'')">
                    </div>
                    &nbsp; &nbsp;&nbsp;<input type="submit" class="btn btn-outline-success" name="add_list" value="+add to diary">
                    <input type="submit" class="btn btn-primary" name="submit" value="submit" style="float:right">
                    <input type="reset" class="btn btn-danger" name="reset" value="reset" style="float:right">
            </div>
        </form>
          <!-- END: diary form -->

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
          <span></span>
{% endblock %}
      </div>

      <!-- Loader -->
      <div id="site-overlayer"></div>
      <div class="site-loader-wrap">
        <div class="site-loader"></div>
      </div>

      <!-- BEGIN: JavaScripts -->
      <script src="/static/js/jquery-3.4.1.min.js"></script>
      <script src="/static/js/popper.min.js"></script>
      <script src="/static/js/bootstrap.min.js"></script>
      <script src="/static/js/jquery.waypoints.min.js"></script>
      <script src="/static/js/jquery.animateNumber.min.js"></script>
      <script src="/static/js/tiny-slider.js"></script>
      <script src="/static/js/jquery.fancybox.min.js"></script>
      <script src="/static/js/jquery.lavalamp.min.js"></script>
      <script src="/static/js/jquery.ajaxchimp.min.js"></script>
      <script src="/static/js/jquery.validate.min.js"></script>
      <script src="/static/js/jquery.easing.1.3.js"></script>
      <script src="/static/js/main.js"></script>

      <script src="/static/js/select.js"></script>
      <script src="/static/js/select_food.js"></script>


      <!--   Core JS Files   -->
      <script src="/static/assets/plugins/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>
      <script src="/static/assets/plugins/backstretch/backstretch.js" type="text/javascript"></script>
      <script src="/static/assets/js/app.js"></script>


      <!-- END: JavaScripts -->
</body>
<script>
    var global_cat = 0;
    $("#category").change(function () {
      var e = document.getElementById('category');
      var url = $("#DiaryForm").attr("data-portion-url");
      var categoryId = $('#category').val();

      global_cat = categoryId;
      $.ajax({
        url: url,
        data: {
          'category': global_cat
        },
        success: function (data) {
            $("#portion").html(data);
        }

      });

    });
  </script>

<script>
    $(document).ready(function () {
        var time = new Date();
        var day = ("0" + time.getDate()).slice(-2);
        var month = ("0" + (time.getMonth() + 1)).slice(-2);
        var today = time.getFullYear() + "-" + (month) + "-" + (day);
        $('#date').val(today);
    })
</script>
{% else %}
<script type="text/javascript">
    window.location.href = "/please_login/";
</script>
{% endif %}